(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{"/94A":function(e){e.exports=JSON.parse('{"root":["index","setup"],"References":{"Community articles":"/community/articles","API documentation":"https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/index.html","Release notes":"/release-notes"},"Server":["server-basics","server-decorator","server-grpc","server-thrift","server-docservice","server-annotated-service","server-http-file","server-servlet","server-access-log","server-cors","server-sse"],"Client":["client-http","client-thrift","client-grpc","client-decorator","client-retrofit","client-custom-http-headers","client-timeouts","client-retry","client-circuit-breaker","client-service-discovery"],"Advanced":["advanced-logging","advanced-structured-logging","advanced-custom-attributes","advanced-structured-logging-kafka","advanced-unit-testing","advanced-production-checklist","advanced-zipkin","advanced-zookeeper","advanced-saml","advanced-spring-webflux-integration","advanced-dropwizard-integration"]}')},AMUl:function(e){e.exports=JSON.parse('{"data":{"allMdx":{"nodes":[{"tableOfContents":{"items":[{"url":"#requestcontext-custom-attributes","title":"RequestContext custom attributes"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"advanced-custom-attributes"}},{"tableOfContents":{"items":[{"url":"#using-armeria-with-dropwizard","title":"Using Armeria with Dropwizard"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"advanced-dropwizard-integration"}},{"tableOfContents":{"items":[{"url":"#production-checklist","title":"Production checklist"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"advanced-production-checklist"}},{"tableOfContents":{"items":[{"url":"#logging-contextual-information","title":"Logging contextual information"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"advanced-logging"}},{"tableOfContents":{"items":[{"url":"#saml-single-sign-on","title":"SAML Single Sign-On"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"advanced-saml"}},{"tableOfContents":{"items":[{"url":"#using-armeria-with-spring-webflux","title":"Using Armeria with Spring WebFlux"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"advanced-spring-webflux-integration"}},{"tableOfContents":{"items":[{"url":"#structured-logging","title":"Structured logging"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"advanced-structured-logging"}},{"tableOfContents":{"items":[{"url":"#unit-testing-client-and-service","title":"Unit-testing Client and Service"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"advanced-unit-testing"}},{"tableOfContents":{"items":[{"url":"#zipkin-integration","title":"Zipkin integration"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"advanced-zipkin"}},{"tableOfContents":{"items":[{"url":"#service-discovery-with-zookeeper","title":"Service discovery with ZooKeeper"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"advanced-zookeeper"}},{"tableOfContents":{"items":[{"url":"#structured-logging-with-kafka","title":"Structured logging with Kafka"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"advanced-structured-logging-kafka"}},{"tableOfContents":{"items":[{"url":"#sending-custom-http-headers","title":"Sending custom HTTP headers"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"client-custom-http-headers"}},{"tableOfContents":{"items":[{"url":"#decorating-a-client","title":"Decorating a client"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"client-decorator"}},{"tableOfContents":{"items":[{"url":"#circuit-breaker","title":"Circuit breaker"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"client-circuit-breaker"}},{"tableOfContents":{"items":[{"url":"#calling-a-grpc-service","title":"Calling a gRPC service"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"client-grpc"}},{"tableOfContents":{"items":[{"url":"#retrofit-integration","title":"Retrofit integration"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"client-retrofit"}},{"tableOfContents":{"items":[{"url":"#calling-an-http-service","title":"Calling an HTTP service"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"client-http"}},{"tableOfContents":{"items":[{"url":"#automatic-retry","title":"Automatic retry"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"client-retry"}},{"tableOfContents":{"items":[{"url":"#client-side-load-balancing-and-service-discovery","title":"Client-side load balancing and service discovery"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"client-service-discovery"}},{"tableOfContents":{"items":[{"url":"#calling-a-thrift-service","title":"Calling a Thrift service"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"client-thrift"}},{"tableOfContents":{"items":[{"url":"#overriding-client-timeouts","title":"Overriding client timeouts"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"client-timeouts"}},{"tableOfContents":{"items":[{"url":"#writing-an-access-log","title":"Writing an access log"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"server-access-log"}},{"tableOfContents":{"items":[{"url":"#user-manual","title":"User manual"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"index"}},{"tableOfContents":{"items":[{"url":"#annotated-services","title":"Annotated services"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"server-annotated-service"}},{"tableOfContents":{"items":[{"url":"#server-basics","title":"Server basics"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"server-basics"}},{"tableOfContents":{"items":[{"url":"#configuring-cors","title":"Configuring CORS"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"server-cors"}},{"tableOfContents":{"items":[{"url":"#decorating-a-service","title":"Decorating a service"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"server-decorator"}},{"tableOfContents":{"items":[{"url":"#browsing-and-invoking-services-with-docservice","title":"Browsing and invoking services with DocService"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"server-docservice"}},{"tableOfContents":{"items":[{"url":"#running-a-grpc-service","title":"Running a gRPC service"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"server-grpc"}},{"tableOfContents":{"items":[{"url":"#serving-static-files","title":"Serving static files"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"server-http-file"}},{"tableOfContents":{"items":[{"url":"#embedding-a-servlet-container","title":"Embedding a servlet container"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"server-servlet"}},{"tableOfContents":{"items":[{"url":"#serving-server-sent-events","title":"Serving Server-Sent Events"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"server-sse"}},{"tableOfContents":{"items":[{"url":"#running-a-thrift-service","title":"Running a Thrift service"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"server-thrift"}},{"tableOfContents":{"items":[{"url":"#setting-up-a-project","title":"Setting up a project"}]},"parent":{"__typename":"File","sourceInstanceName":"docs","name":"setup"}}]}}}')},pWDZ:function(e,t,n){"use strict";n.r(t),n.d(t,"pageTitle",(function(){return r})),n.d(t,"_frontmatter",(function(){return s})),n.d(t,"default",(function(){return o}));n("8x/H"),n("UsjJ"),n("tKM+"),n("q1tI");var a=n("7ljp"),i=n("xCMr");var r="Sending custom HTTP headers",s={},c={pageTitle:r,_frontmatter:s},l=i.a;function o(e){var t=e.components,n=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,["components"]);return Object(a.b)(l,Object.assign({},c,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("h1",{id:"sending-custom-http-headers",style:{position:"relative"}},Object(a.b)("a",Object.assign({parentName:"h1"},{href:"#sending-custom-http-headers","aria-label":"sending custom http headers permalink",className:"anchor before"}),Object(a.b)("svg",Object.assign({parentName:"a"},{"aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"}),Object(a.b)("path",Object.assign({parentName:"svg"},{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"})))),"Sending custom HTTP headers"),Object(a.b)("h6",{className:"inlinePageToc",role:"navigation"},"Table of contents"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object.assign({parentName:"li"},{href:"#using-clientswithhttpheaders"}),"Using Clients.withHttpHeaders()")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object.assign({parentName:"li"},{href:"#using-clientoptionhttp_headers"}),"Using ClientOption.HTTP_HEADERS")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object.assign({parentName:"li"},{href:"#using-clientbuilderdecorator"}),"Using ClientBuilder.decorator()")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object.assign({parentName:"li"},{href:"#using-a-derived-client"}),"Using a derived client"))),Object(a.b)("p",null,"When sending an RPC request, it is sometimes required to send HTTP headers with it, such as an authentication token.\nThere are four ways to customize the HTTP headers of your RPC request:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Using the ",Object(a.b)("inlineCode",{parentName:"li"},"Clients.withHttpHeaders()")," method"),Object(a.b)("li",{parentName:"ul"},"Using the ",Object(a.b)("inlineCode",{parentName:"li"},"ClientOption.HTTP_HEADERS")," option"),Object(a.b)("li",{parentName:"ul"},"Using the ",Object(a.b)("inlineCode",{parentName:"li"},"ClientBuilder.decorator()")," method"),Object(a.b)("li",{parentName:"ul"},"Using a derived client")),Object(a.b)("h2",{id:"using-clientswithhttpheaders",style:{position:"relative"}},Object(a.b)("a",Object.assign({parentName:"h2"},{href:"#using-clientswithhttpheaders","aria-label":"using clientswithhttpheaders permalink",className:"anchor before"}),Object(a.b)("svg",Object.assign({parentName:"a"},{"aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"}),Object(a.b)("path",Object.assign({parentName:"svg"},{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"})))),"Using ",Object(a.b)("inlineCode",{parentName:"h2"},"Clients.withHttpHeaders()")),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-java"}),'import static com.linecorp.armeria.common.HttpHeaderNames.AUTHORIZATION;\nimport com.linecorp.armeria.common.util.SafeCloseable;\nimport com.linecorp.armeria.client.Clients;\n\nHelloService.Iface client = Clients.newClient("tbinary+http://example.com/hello",\n                                               HelloService.Iface.class);\ntry (SafeCloseable ignored = Clients.withHttpHeaders(\n        headers -> headers.set(AUTHORIZATION, credential))) {\n    client.hello("authorized personnel");\n}\n')),Object(a.b)("p",null,"If you are setting only a single header, you can use ",Object(a.b)("inlineCode",{parentName:"p"},"Clients.withHttpHeader()")," simply:"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-java"}),'try (SafeCloseable ignored = Clients.withHttpHeader(AUTHORIZATION, credential)) {\n    client.hello("authorized personnel");\n}\n')),Object(a.b)("p",null,"You can also nest ",Object(a.b)("inlineCode",{parentName:"p"},"withHttpHeader(s)"),". The following example will send both ",Object(a.b)("inlineCode",{parentName:"p"},"user-agent")," header and\n",Object(a.b)("inlineCode",{parentName:"p"},"authorization")," header when calling ",Object(a.b)("inlineCode",{parentName:"p"},"client.hello()"),":"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-java"}),'import static com.linecorp.armeria.common.HttpHeaderNames.USER_AGENT;\n\ntry (SafeCloseable ignored1 = Clients.withHttpHeader(USER_AGENT, myUserAgent)) {\n    for (String cred : credentials) {\n        try (SafeCloseable ignored2 = Clients.withHttpHeaders(AUTHORIZATION, cred)) {\n            client.hello("authorized personnel");\n        }\n    }\n}\n')),Object(a.b)("h2",{id:"using-clientoptionhttp_headers",style:{position:"relative"}},Object(a.b)("a",Object.assign({parentName:"h2"},{href:"#using-clientoptionhttp_headers","aria-label":"using clientoptionhttp_headers permalink",className:"anchor before"}),Object(a.b)("svg",Object.assign({parentName:"a"},{"aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"}),Object(a.b)("path",Object.assign({parentName:"svg"},{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"})))),"Using ",Object(a.b)("inlineCode",{parentName:"h2"},"ClientOption.HTTP_HEADERS")),Object(a.b)("p",null,"If you have a custom HTTP header whose value does not change often, you can use ",Object(a.b)("inlineCode",{parentName:"p"},"ClientOption.HTTP_HEADERS"),"\nwhich is more efficient:"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-java"}),'import static com.linecorp.armeria.common.HttpHeaderNames.AUTHORIZATION;\nimport com.linecorp.armeria.common.HttpHeaders;\nimport com.linecorp.armeria.client.ClientBuilder;\nimport com.linecorp.armeria.client.ClientOption;\n\nClientBuilder cb = Clients.builder("tbinary+http://example.com/hello");\ncb.setHttpHeader(AUTHORIZATION, credential);\n// or:\n// cb.option(ClientOption.HTTP_HEADERS, HttpHeaders.of(AUTHORIZATION, credential));\nHelloService.Iface client = cb.build(HelloService.Iface.class);\nclient.hello("authorized personnel");\n')),Object(a.b)("h2",{id:"using-clientbuilderdecorator",style:{position:"relative"}},Object(a.b)("a",Object.assign({parentName:"h2"},{href:"#using-clientbuilderdecorator","aria-label":"using clientbuilderdecorator permalink",className:"anchor before"}),Object(a.b)("svg",Object.assign({parentName:"a"},{"aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"}),Object(a.b)("path",Object.assign({parentName:"svg"},{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"})))),"Using ",Object(a.b)("inlineCode",{parentName:"h2"},"ClientBuilder.decorator()")),Object(a.b)("p",null,"If you want more freedom on how you manipulate the request headers, use a decorator:"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-java"}),'ClientBuilder cb = Clients.builder("tbinary+http://example.com/hello");\n\n// Add a decorator that inserts the custom header.\ncb.decorator((delegate, ctx, req) -> { // See DecoratingHttpClientFunction and DecoratingRpcClientFunction.\n    HttpRequest newReq = req.withHeaders(req.headers().toBuilder().set(AUTHORIZATION, credential));\n    ctx.updateRequest(newReq);\n    return delegate.execute(ctx, newReq);\n});\n\nHelloService.Iface client = cb.build(HelloService.Iface.class);\nclient.hello("authorized personnel");\n')),Object(a.b)("p",null,"Note that this method is as efficient as the ",Object(a.b)("inlineCode",{parentName:"p"},"ClientOption.HTTP_HEADERS")," option. Choose whichever you prefer."),Object(a.b)("h2",{id:"using-a-derived-client",style:{position:"relative"}},Object(a.b)("a",Object.assign({parentName:"h2"},{href:"#using-a-derived-client","aria-label":"using a derived client permalink",className:"anchor before"}),Object(a.b)("svg",Object.assign({parentName:"a"},{"aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"}),Object(a.b)("path",Object.assign({parentName:"svg"},{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"})))),"Using a derived client"),Object(a.b)("p",null,"Although not as simple as using ",Object(a.b)("inlineCode",{parentName:"p"},"withHttpHeaders()"),", you can create a derived client to add more custom\nheaders to an existing client:"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-java"}),"HelloService.Iface client = ...;\nHelloService.Iface derivedClient = Clients.newDerivedClient(client, options -> {\n    return ClientOptions.builder()\n                        .options(options)\n                        .decorator(...)  // Add a decorator.\n                        .httpHeader(AUTHORIZATION, credential)  // Add an HTTP header.\n                        .build();\n});\n")))}o.isMDXComponent=!0},xCMr:function(e,t,n){"use strict";n("UsjJ");var a=n("AMUl"),i=n("q1tI"),r=n.n(i),s=n("/94A"),c=n("+ejy");t.a=function(e){var t=a.data.allMdx.nodes;return r.a.createElement(c.a,Object.assign({},e,{candidateMdxNodes:t,index:s,prefix:"docs",pageTitleSuffix:"Armeria documentation"}))}}}]);
//# sourceMappingURL=component---src-pages-docs-client-custom-http-headers-mdx-b94e57851ed042f268a7.js.map